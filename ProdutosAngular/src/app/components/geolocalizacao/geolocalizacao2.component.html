<div class="container d-flex flex-column">
  <ul class="nav nav-tabs flex-grow-0">
    <li class="nav-item">
      <a class="nav-link" routerLink="/geoloc">LOCALIZAR POR IP</a>
    </li>
    <li class="nav-item">
      <a class="nav-link disabled">LOCALIZAR POR CEP</a>
    </li>
  </ul>

  <div class="card my-5">
    <div class="card-body">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center gap-2">
          <label for="cepBusca" class="mb-0 fw-semibold">Digite o CEP</label>
          <input
            type="text"
            class="form-control" style="width: 160px;"
            id="cepBusca"
            name="cepBusca"
            [(ngModel)]="cepBusca"
            mask="00000-000"
            [showMaskTyped]="true"
            placeholder="00000-000"
          />
          <button class="btn btn-primary" [disabled]="carregando" (click)="buscarEnderecoPorCep(cepBusca)">
            <span *ngIf="!carregando">Buscar CEP</span>
            <span *ngIf="carregando" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          </button>
        </div>
        <div *ngIf="carregando" class="text-primary fw-semibold">
          {{ carregandoTexto || 'Processando...' }}
        </div>
      </div>

      <div class="div-tabela" [class.desabilitado-durante-carregamento]="carregando" *ngIf="endereco as e">
        <table class="table table-bordered" style="width: 100%; table-layout: fixed;">
          <thead>
          <tr>
            <th colspan="6" class="text-center">Localização através de CEP</th>
          </tr>
          </thead>
          <tbody>

          <!-- Linha 1: CEP / Logradouro / Complemento -->
          <tr>
            <td style="width: 12%;">
              <label for="cep">CEP:</label>
            </td>
            <td style="width: 16%;">
              <input
                type="text"
                class="form-control"
                id="cep"
                name="cep"
                [(ngModel)]="e.cep"
                mask="00000-000"
                [showMaskTyped]="true"
                placeholder="00000-000"
                required
              />
            </td>

            <td style="width: 16%;">
              <label for="logradouro">Logradouro:</label>
            </td>
            <td style="width: 24%;">
              <input
                type="text"
                [(ngModel)]="e.logradouro"
                class="form-control"
                id="logradouro"
                name="logradouroFornecedor"
                readonly
              />
            </td>
            <td style="width: 12%;">
              <label for="complemento">Complemento:</label>
            </td>
            <td style="width: 20%;">
              <input
                type="text"
                [(ngModel)]="e.complemento"
                class="form-control"
                id="complemento"
                name="complementoFornecedor"
              />
            </td>
          </tr>

          <!-- Linha 3: Unidade e Bairro -->
          <tr>
            <td style="width: 16%;">
              <label for="unidade">Unidade:</label>
            </td>
            <td style="width: 24%;">
              <input
                type="text"
                [(ngModel)]="e.unidade"
                class="form-control"
                id="unidade"
                name="unidadeFornecedor"
                readonly
              />
            </td>
            <td style="width: 12%;">
              <label for="bairro">Bairro:</label>
            </td>
            <td colspan="3" style="width: 48%;">
              <input
                type="text"
                [(ngModel)]="e.bairro"
                class="form-control"
                id="bairro"
                name="bairroFornecedor"
                readonly
              />
            </td>
          </tr>

          <!-- Linha 4: Cidade, UF, Estado -->
          <tr>
            <td style="width: 16%;">
              <label for="localidade">Cidade:</label>
            </td>
            <td style="width: 24%;">
              <input
                type="text"
                [(ngModel)]="e.localidade"
                class="form-control"
                id="localidade"
                name="localidadeFornecedor"
                readonly
              />
            </td>
          </tr>
          </tbody>
          </table>
            <!-- ...sua tabela... -->

<!-- Renderiza o mapa só quando a API carregar e já houver coordenadas -->
<div class="map-wrapper" *ngIf="apiLoaded && obteveCoordenadas">
  <div class="map-inner">
    <google-map
      #gm
      [center]="center"
      [zoom]="zoom"
      [options]="mapOptions"
      [width]="'100%'"
      [height]="'100%'">
      <map-marker
        [position]="marker.position"
        [title]="marker.title"
        [options]="marker.options">
      </map-marker>
    </google-map>
  </div>
</div>
