# Configuração do servidor
server.port=8080

# Nome da aplicação
spring.application.name=api-gateway

# ===============================================================================
# CONFIGURAÇÃO JWT
# ===============================================================================
jwt.secret=VGhpc0lzQVNlY3VyZVNlY3JldEtleTIwMjU=
jwt.expiration=15

# ===============================================================================
# CONFIGURAÇÕES EUREKA CLIENT - EVITA MÚLTIPLAS INSTÂNCIAS
# ===============================================================================
eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true

# ID único da instância (baseado em porta + timestamp)
eureka.instance.instance-id=${spring.application.name}:${server.port}:${random.value}

# Configurações para desenvolvimento - renovação mais rápida
eureka.instance.prefer-ip-address=true
eureka.instance.lease-renewal-interval-in-seconds=10
eureka.instance.lease-expiration-duration-in-seconds=10

# Força registro imediato
eureka.client.initial-instance-info-replication-interval-seconds=5
eureka.client.instance-info-replication-interval-seconds=10
eureka.client.registry-fetch-interval-seconds=10

# Configuração do Spring Cloud Gateway
#spring.cloud.gateway.discovery.locator.enabled=true
#spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# Rotas personalizadas
# Rota para usuários
spring.cloud.gateway.server.webflux.routes[0].id=api-prodify-usuarios
spring.cloud.gateway.server.webflux.routes[0].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/usuarios/**
spring.cloud.gateway.server.webflux.routes[0].filters[0]=StripPrefix=0

# Fornecedores
spring.cloud.gateway.server.webflux.routes[1].id=api-prodify-fornecedores
spring.cloud.gateway.server.webflux.routes[1].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/fornecedores/**
spring.cloud.gateway.server.webflux.routes[1].filters[0]=StripPrefix=0

# Localização
spring.cloud.gateway.server.webflux.routes[2].id=api-prodify-localizacao
spring.cloud.gateway.server.webflux.routes[2].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/api/localizacao/**
spring.cloud.gateway.server.webflux.routes[2].filters[0]=StripPrefix=0

# Produtos (vai para api-prodify, que chama produto-service via Feign)
spring.cloud.gateway.server.webflux.routes[3].id=api-prodify-produtos
spring.cloud.gateway.server.webflux.routes[3].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/api/produtos/**

# ==============================
# ROTA PARA SWAGGER DO API-PRODIFY
# ==============================

# Redireciona o Swagger UI
spring.cloud.gateway.server.webflux.routes[4].id=swagger-ui
spring.cloud.gateway.server.webflux.routes[4].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/swagger-ui/**
spring.cloud.gateway.server.webflux.routes[4].filters[0]=StripPrefix=0

# Redireciona a spec OpenAPI (JSON)
spring.cloud.gateway.server.webflux.routes[5].id=swagger-api-docs
spring.cloud.gateway.server.webflux.routes[5].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[5].predicates[0]=Path=/v3/api-docs/**
spring.cloud.gateway.server.webflux.routes[5].filters[0]=StripPrefix=0

# Auth (login, refresh, logout)
spring.cloud.gateway.server.webflux.routes[6].id=api-prodify-auth
spring.cloud.gateway.server.webflux.routes[6].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[6].predicates[0]=Path=/api/auth/**
spring.cloud.gateway.server.webflux.routes[6].filters[0]=StripPrefix=0

# PDV (ponto de venda)
spring.cloud.gateway.server.webflux.routes[7].id=api-prodify-pdv
spring.cloud.gateway.server.webflux.routes[7].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[7].predicates[0]=Path=/api/pdv/**
spring.cloud.gateway.server.webflux.routes[7].filters[0]=StripPrefix=0

# Compras (compra, historico de compras)
spring.cloud.gateway.server.webflux.routes[8].id=api-prodify-compras
spring.cloud.gateway.server.webflux.routes[8].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[8].predicates[0]=Path=/api/compras/**
spring.cloud.gateway.server.webflux.routes[8].filters[0]=StripPrefix=0

# Relatórios
spring.cloud.gateway.server.webflux.routes[9].id=api-prodify-relatorios
spring.cloud.gateway.server.webflux.routes[9].uri=lb://api-prodify
spring.cloud.gateway.server.webflux.routes[9].predicates[0]=Path=/api/relatorios/**
spring.cloud.gateway.server.webflux.routes[9].filters[0]=StripPrefix=0