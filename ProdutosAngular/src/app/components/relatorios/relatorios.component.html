<div class="card my-4">
  <div class="card-body">
    <h5 class="mb-3">Relatório de transações econômicas</h5>

    <div class="d-flex justify-content-between align-items-center mb-2">
      <div class="h6 mb-0 text-secondary">Transações (mais recentes primeiro)</div>
      <button class="btn btn-outline-primary btn-sm" (click)="baixarPdf()">
        <i class="bi bi-file-earmark-pdf"></i>
        Exportar PDF
      </button>
    </div>

    <div *ngIf="transacoes.length === 0" class="text-muted">Nenhuma transação encontrada.</div>

    <div *ngIf="transacoes.length > 0" class="tabela-wrapper">
      <table class="table table-sm table-hover table-bordered relatorio-tabela">
        <thead>
          <tr>
            <th>Tipo</th>
            <th>ID</th>
            <th>Data</th>
            <th class="text-end">Qtd</th>
            <th class="text-end">Total</th>
            <th class="text-end">Saldo após</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let t of transacoesPaginadas; let i = index" [ngClass]="{ 'linha-venda': t.tipo === 'VENDA', 'linha-compra': t.tipo === 'COMPRA' }">
            <td>{{ t.tipo === 'VENDA' ? 'Venda' : 'Compra' }}</td>
            <td>#{{ t.id }}</td>
            <td class="text-muted">{{ t.data | date:'dd/MM/yyyy HH:mm' }}</td>
            <td class="text-end">{{ t.totalQuantidade }}</td>
            <td class="text-end">{{ t.totalValor | currency:'BRL':'symbol':'1.2-2' }}</td>
            <td class="text-end" [ngClass]="{ 'text-success': t.tipo === 'VENDA', 'text-danger': t.tipo === 'COMPRA' }">
              {{ getSaldoAposTransacaoGlobal(i) | currency:'BRL':'symbol':'1.2-2' }}
            </td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-container d-flex justify-content-start mt-2">
        <mat-paginator [length]="totalRecords"
                       [pageSize]="pageSize"
                       [pageIndex]="currentPage"
                       (page)="onPageChange($event)"
                       [pageSizeOptions]="[10, 20, 50]">
        </mat-paginator>
      </div>
    </div>
  </div>
</div>
